Implementação do comando resolver

A função do comando resolver consiste num ciclo com 3 condições de paragem:
1. O tabuleiro está resolvido. Esta condição é verificada recorrendo à função "resolvido", que percorre o tabuleiro à procura de posições indeterminadas, isto é, posições cujo caractere é 'o' ou '.'.
2. O tabuleiro não é válido. Esta condição é verificada recorrendo à estrutura "data", que funciona como um valor de retorno de certas funcões e foi criada como resposta à necessidade dessas funções retornarem não só se efetuaram ou não alterações ao tabuleiro, bem como se "descobriram" que o tabuleiro é inválido. Na estrutura, o campo "val" corresponde à (in)validade do tabuleiro, tomando o valor 1 se este for inválido, e o campo "alt" toma o valor 1 se a função efetuou alterações ao tabuleiro.
3. A última iteração do ciclo não conseguiu efetuar qualquer alteração no tabuleiro. Esta condição é verificada recorrendo à estrutura "data", referida na alínea anterior, consultando o valor do campo "alt". Para garantir que o ciclo seja sempre executado pelo menos uma vez, esse campo toma o valor 1 no início da função.

Dentro desse ciclo principal existem:
- Um ciclo, com as condições de paragem explicadas nas alíneas 2. e 3. anteriores, que se limita a aplicar as estratégias de resolução (1, 2, 3 e A1), até que as mesmas não efetuem quaisquer alterações no tabuleiro, ou se "descubra" que o tabuleiro não é válido.
- Uma condição que verifica se o valor do campo "val" da estrutura "data" é igual a 0, ou seja, se alguma das estratégias aplicadas no ciclo anterior "descobriu" que o tabuleiro é inválido. Caso o tabuleiro seja válido, chama-se a função "descobrir". Caso contrário, é imprimida uma mensagem no ecrã a dizer que o tabuleiro é inválido.

Funções criadas para auxiliar o comando resolver:
- Função "descobrir", que percorre todo o tabuleiro, temporariamente substituindo cada posição indeterminada por um segmento (indeterminados) de barco, ou seja, substituindo o caractere '.' pelo caractere 'o'. Para cada posição substituida, é executado o comando V. Se o tabuleiro não for válido, podemos garantir que nessa posição não estará um segmento de um barco, portanto colocamos água. Caso contrário, nada podemos concluir, portanto a posição volta ao estado anterior ('.'), usando o undo dentro da função do comando V.
- Função "EA1", uma estratégia de resolução que consiste em procurar segmentos de barco e preencher com um 'o' as posições indeterminadas adjacentes aos segmentos que se pode garantir que também têm um segmento de barco. Existe também uma função auxiliar, chamada "EA1centro" que é executada no caso em que o segmento é o centro de um barco ('#'). Sempre que existe um centro de um barco, o número de segmentos da linha ou da coluna, dependendo da orientação do barco, será sempre pelo menos 3 (o centro do barco e as duas extremidades). Essa função começa por verificar essa condição. Se o número de segmentos da linha ou da coluna onde está o barco for menor ou igual a 2, ficaremos a saber a orientação do barco e preenchemos as posições adjacentes com água de acordo com a orientação do barco: se o barco estiver orientado horizontalmente, as posições imediatamente acima e abaixo do barco serão água; se o barco estiver orientado verticalmente, as posições imediatamente à esquerda e à direita do barco serão água. De seguida, a função também se encarga de, nos casos em que sabemos a orientação do barco (verificando a existência de água nas posições acima, abaixo, à esquerda e à direita do barco), preencher com 'o' as posições adjacentes ao centro do barco que sabemos que terão um segmento de barco, de acordo com a sua orientação.

Funções alteradas para auxiliar o comando resolver:
- A função da estratégia 3 passou também a determinar os segmentos de barco indeterminados ('o'), recorrendo a uma nova função auxiliar, "E3ocupados", que verifica as posições adjacentes à procura de casos em que é possível saber-se de que tipo de segmento se trata.
- As funções dos comandos h, v e p passaram a receber também um apontador para a estrutura "data", de forma a que possam indicar, através do campo "alt" se efetuaram alterações ao tabuleiro, para que se saiba se as estratégias que as usam efetuaram alterações.
- A função pComand também indica, através do campo "val" da estrutura "data", que o tabuleiro é inválido, nos casos em que se tenta colocar um segmento de barco numa posição que tem água, ou água numa posição que tem um segmento de barco.